<html lang="en" ng-app="scouting" ng-controller="homepage">
    <head>
        <title>Scouting</title>
    </head>
    <style>
        body{
            padding: 0;
            margin: 0;
            font-family: sans-serif;
        }
        #contianer{
            width: 1024px;
            height: 528px;
            overflow: hidden;
        }
            #home_screen{
                width: 1024px;
                height: 388px;
                position: relative;
            }
        #title_screen{
            width: 1024px;
            height: 250px;
            background: #e41e26;
            box-shadow: 0px 0px 10px #000;
            border-bottom: thin solid #000;
            position: relative;
            z-index: 1;
        }
            #title_screen #title{
                position: absolute;
                top: 50%;
                left: 50%;
                height: 213px;
                margin-top: -106.5px;
                margin-left: -394px;
            }
        #login_inputs-container{
            width: 1024px;
            height: 271px;
            position: absolute;
            background: #474747;
        }
        #login_inputs{
            height: 200px;
            width: 930px;
            margin: auto;
            margin-top: 40px;
            position: relative;
        }
        #login_inputs input{ width: 458px; height: 70px; padding-left: 10px; font-size: 50px; border: thin solid #cccccc; float: left; }
        
        #ready_button{
            background: #34aa49;
            border-radius: 10px;
            margin-top: -28px;
            width: 930px;
            height: 76px;
            position: absolute;
            bottom: 0px;
            box-shadow: 0px 6px 0px #2a803f;
            color: #2a803f;
        }
        #ready_button:hover{
            color: #fff;
            background: #2a803f;
            box-shadow: inset 0px 0px 5px #000;
        }
        #ready_button div{ 
            width: 930px;
            height: 77px;
            display: table-cell;
            vertical-align: middle;
            text-align: center;
            font-size: 58px;
            font-weight: bold;

        }
        
        
        h1,h2,h3,h4,h5,p {
            padding: 0;
            margin: 0;
        }



        /*Scouting portion*/
        #scouting-container{
            position: absolute;
            top: 0;
            z-index: -1;
        }
        #title_bar{
            background: #e8e8e8;
            height: 60px;
            width: 1024px;
            position: relative;
            z-index: 1;
            box-shadow: 0px 0px 5px #000;
        }
        #field-diagram-table {
            width: 1024px;
            height: 433px;
            border-collapse: separate; 
            border-spacing: 2px; 
            background-color:#273F2E;
            margin:0;
            padding: 0;
        }
        #field-diagram-table td {
            height: 75px;
            vertical-align: middle;
            margin:0;
            text-decoration: none;
        }        
        #field-diagram-table td a {
            display:block;
            width:100%;
            height: 100%;
            text-align: center;
            color: #fff;
            text-decoration: none;
        }
        #field-diagram-table td a div {
            position: relative;
            top: 33%;
            width: 190px;
            font-size: 20px;
        }
        
        .field-column-header { width: 100px; }
        #field-diagram-table td.blue-outline { border: 2px solid blue; }
        #field-diagram-table td.white-outline { border: 2px solid white; }
        #field-diagram-table td.blue-defense { background-color: blue; border: 2px solid yellow; }
        #field-diagram-table td.red-outline { border: 2px solid red; }
        #field-diagram-table td.red-defense { background-color: red; border: 2px solid yellow; }

        #scouting_team{
            float: left;
            margin: 4px 0px 0px 10px;
            border: thin solid #333;
            padding: 0px 20px;
            font-size: 30px;
        }
        .red{
            background: red;
            color: #fff;
        }
        .blue{
            background: blue;
            color: #fff;
        }
        #scouter_name{
            float: right;
            height: 30px;
            font-size: 30px;
            margin: 10px 10px 0 0;
        }

        #scouter_time{
            font-size: 30px;
            width: 100%;
            padding-top: 10px;
            text-align: center;
        }
        #scouter-time-bar{
            width: 100%;
            height: 10px;
            background: #333;
            position: absolute;
            bottom: 0px;
        }
    #overlay{
        width: 100%;
        height: 100%;
        position: absolute;
        background: #000;
        opacity: 0.3;
        z-index: 5;
        display: none;
    }
    #lightbox{
        background: #cccccc;
        height: 300px;
        width: 800px;
        position: absolute;
        z-index: 5;
        left: 50%;
        top: 50%;
        margin-left: -400px;
        margin-top: -150px;
        display: none;
    }
        #lightbox #title, #scout-title #title{
            width: 100%;
            height: 70px;
            background: #474747;
            position: relative;
        }
        #lightbox #button{
            background: #ebebeb;
            color: #4c4c4d;
            border-radius: 5px;
            box-shadow: 0px 3px 0px #bcbcbc;
            font-size: 20px;
            font-weight: 400;
            padding: 5px 10px;
            text-align: center;
            margin: 10px 10px;
        }
        #lightbox #button:hover{
            box-shadow: inset 0px 0px 5px #000;
            background: #4c4c4d;
            color: #fff;
        }
            #lightbox #title_container{
                position: relative;
            }
            #lightbox #title_container div{
                width: 100%;
                text-align: center;
                color: #fff;
                position: absolute;
                bottom: 10px;
                font-size: 25px;
            }
            .active{
                background: #ee2724!important;
                box-shadow: inset 0px 0px 10px #000!important;
                color: #fff!important;
            }



            #time-bar{
                height: 10px;
                width: 0px;
                background: #34aa49;
                box-shadow: inset 0px 0px 5px #000;
            }
            .yellow{                                                    
                background: yellow!important;
            }
            .red{
                background: red!important;
            }



            /* SCOUTING OVERLAY */
            #scouting_overlay{
                width: 100%;
                height: 100%;
                position: absolute;
                z-index: 1;
            }
            #scout-title{
                width: 500px;
                height: 250px;
                position: absolute;
                left: 50%;
                top: 50%;
                margin-top: -100px;
                margin-left: -250px;
                background: #ccc;
                z-index: 1;
            }
    </style>
    <body>
        <div id="contianer">
          
            <div ng-click="close_lightbox()" id="overlay"></div>  
            <div id="lightbox">
                <div id="title">
                    <div ng-if="lb_change == 'climb'" id="title_container" style="float: left; width: 25%; height: 100%; border-right: thin solid #ccc;">
                        <img style="position: absolute; left: 10px; bottom: 4px;" src="images/tower_png.png"" />
                        <div style="left: 40px; top: 10px;">Tower</div>
                        <div style="left: 43px; top: 38px; font-size: 16px;">Final</div>
                    </div>

                    <div ng-if="lb_change !== 'climb'" id="title_container" style="float: left; width: 25%; height: 100%; border-right: thin solid #ccc;">
                        <img style="position: absolute; left: -3px; bottom: 4px;" width="100px" src="images/Defenses/C-2.png" />
                        <div style="left: 40px; top: 10px;">Defense</div>
                        <div style="left: 43px; top: 38px; font-size: 16px;">Auto/Teleop</div>
                    </div>
                    <div id="title_container" style="float: left; width: 25%; height: 100%; border-right: thin solid #ccc;">
                        <img style="position: absolute; left: 10px; bottom: 5px;" src="images/tower_png.png" />
                        <div style="left: 33px; top: 10px;">Tower</div>
                        <div style="left: 43px; top: 38px; font-size: 16px;">Shot attempt</div>
                    </div>
                    <div id="title_container" style="float: left; width: 25%; height: 100%; border-right: thin solid #ccc;">
                        <img style="position: absolute; left: 15px; bottom: -9px;" width="142px" src="images/robit.png" />
                        <div style="left: 0px; top: 4px;">Robot Actions</div>
                        <div style="left: 43px; top: 38px; font-size: 16px;"></div>
                    </div>
                    <div id="title_container" style="float: left; width: 24%; height: 100%;">
                        <img style="position: absolute; left: 5px; bottom: -3px;" src="images/tablet.png" />
                        <div style="left: 40px; top: 4px;">Scouter<br />Actions</div>
                        <div style="left: 43px; top: 38px; font-size: 16px;"></div>
                    </div>
                </div>
                <div style="position: relative; width: 100%;">
                    
                    <div ng-if="lb_change == 'climb'" style="width: 25%; border-right: thin solid #333; float: left; height: 230px;" id="column">
                        <div ng-click="tower.climb = (tower.climb==false ? true : false); tower.challenge = false" ng-class="{'active': tower.climb, 'not_active': !tower.climb}" id="button">Climbed</div>
                        <div ng-click="tower.challenge = (tower.challenge==false ? true : false); tower.climb = false" ng-class="{'active': tower.challenge, 'not_active': !tower.challenge}" id="button">Challenged</div>

                        <div ng-class="{'active': tower.left, 'not_active': !tower.left}" style="font-size: 17px; float: left; margin-right: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-right: 1px solid #ccc;" id="button">Left</div>
                        <div ng-class="{'active': tower.front, 'not_active': !tower.front}" style="font-size: 17px; border-radius: 0px; float: left; margin-right: 0px; margin-left: 0px;" id="button">Front</div>
                        <div ng-class="{'active': tower.right, 'not_active': !tower.right}" style="font-size: 17px; float: left; margin-left: 0px; border-bottom-left-radius: 0px; border-top-left-radius: 0px; border-left: 1px solid #ccc;" id="button">Right</div>
                    </div>

                    <div ng-if="lb_change !== 'climb'" style="width: 25%; border-right: thin solid #333; float: left; height: 230px;" id="column">
                        <div ng-click="defense.reached = (defense.reached==false ? true : false); defense.crossed=false;" ng-class="{'active': defense.reached, 'not_active': !defense.reached}" id="button">Reached</div>
                        <div ng-click="defense.crossed = (defense.crossed==false ? true : false); defense.reached=false;" ng-class="{'active': defense.crossed, 'not_active': !defense.crossed}" id="button">Crossed</div>
                    </div>

                    <div style="width: 25%; border-right: thin solid #333; float: left; height: 230px;" id="column">
                        <div ng-click="tower.high_goal = (tower.high_goal==false ? true : false); tower.low_goal=false;" ng-class="{'active': tower.high_goal, 'not_active': !tower.high_goal}" id="button">High Goal</div>
                        <div ng-click="tower.low_goal = (tower.low_goal==false ? true : false); tower.high_goal=false" ng-class="{'active': tower.low_goal, 'not_active': !tower.low_goal}" id="button">Low Goal</div>
                    </div>

                    <div style="width: 25%; float: left; height: 230px; border-right: thin solid #333;" id="column">
                        <div ng-click="robotAction.defended = (robotAction.defended==false ? true : false); robotAction.collect=false; robotAction.passed=false;" ng-class="{'active': robotAction.defended, 'not_active': !robotAction.defended}" id="button">Defended Bot</div>
                        <div ng-click="robotAction.defended=false; robotAction.collect = (robotAction.collect==false ? true : false); robotAction.passed=false;" ng-class="{'active': robotAction.collect, 'not_active': !robotAction.collect}" id="button">Collected Boulder</div>
                        <div ng-click="robotAction.defended=false; robotAction.collect=false; robotAction.passed = (robotAction.passed==false ? true : false);" ng-class="{'active': robotAction.passed, 'not_active': !robotAction.passed}" id="button">Passed Boulder</div>
                    </div>
                    <div style="width: 24%; float: left; height: 230px;" id="column">
                        <div ng-click="success = (success==false ? true : false); fail=false" ng-class="{'active': success, 'not_active': !success}" id="button">Success</div>
                        <div ng-click="fail = (fail==false ? true : false); success=false" ng-class="{'active': fail, 'not_active': !fail}" id="button">Fail</div>
                        <hr style="width: 100%;"/>
                        <div id="button">Submit</div>
                        <div ng-click="close_lightbox()" id="button">Cancle</div>

                    </div>

                </div>
            </div>
            
              
            <div id="home_screen">
                <div id="title_screen">
                    
                    <div id="title">
                        <img style="float: left;" height="140px" src="images/team537_gear.png" />
                        <div style="border-left: 3px solid #000; color: #fff; padding-left: 20px; margin-left: 20px; float: left; margin-top: 20px;">
                            <h3 style="font-size: 30px; margin-left: 43px; margin-bottom: -23px;">2016</h3>
                            <h1 style="font-size: 70px;">Scouting System</h1>
                        </div>
                    </div>
                    
                    <h3 ng-if="waiting == true" style="color: #fff; width: 100%; position: absolute; bottom: 30px; font-size: 30px; text-align: center;">Waiting for admin command...</h3>
                </div>
                <div id="login_inputs-container">
                    <div id="login_inputs">
                        <input ng-model="first_name" placeholder="First Name" type="text" />
                        <input ng-model="last_name" style="margin-left: 14px;" placeholder="Last Name" type="text" />
                        <div ng-click="scouter_login()" id="ready_button"><div>READY</div></div>
                    </div>
                </div>
            </div>
            
            <div id="scouting-container">
                <div id="scouting_overlay">
                    <div style="width: 100%; height: 100%; position: absolute; background: #000; opacity: 0.5;"></div>
                    <div id="scout-title">
                        <div id="title">
                            <h1 style="color: #fff; font-size: 35px; text-align: center; position: relative; top: 10px;">Get ready to scout!</h1>
                        </div>
                            <h2 style="text-align: center; padding: 10px;">You are scouting team,</h2>
                            <h1 style="font-size: 100px; color: {{ scouting_data.scouting_team.alliance }}; text-align: center;">{{ scouting_data.scouting_team.number }}</h1>
                     </div>
                </div>

                <div id="title_bar">
                    <div class="{{ scouting_data.scouting_team.alliance }}" id="scouting_team">{{ scouting_data.scouting_team.number }}</div>
                    <div id="scouter_name">{{ first_name }} {{ last_name }}</div>
                    <div id="scouter_time">{{ time.minutes }}:{{ time.seconds }}</div>
                    <div id="scouter-time-bar">
                        <div class="green" id="time-bar"></div>
                    </div>
                </div>
                <table id="field-diagram-table">
                    <tr>
                        <td class="blue-outline"><a ng-click="lightbox()" href="#" id="field-blue-brattice"><div> &nbsp;  &nbsp; </div></a></td>
                        <td class="blue-outline" colspan="2"><a ng-click="lightbox()" href="#" id="field-blue-passage"><div> &nbsp;  &nbsp; </div></a></td>
                        <td class="white-outline" colspan="2" rowspan="3"><a ng-click="lightbox({'tower': false,'feild_pos':'FN'})" href="#" id="field-far-neutral"><div> &nbsp;&nbsp; </div></a></td>
                        <td class="red-defense"><a ng-click="lightbox({'tower': false,'feild_pos':'R1'})" href="#" id="field-red-d1"><div> {{ defenses.RedD1 }} </div></a></td>
                        <td class="white-outline" rowspan="2" colspan="2"><a ng-click="lightbox({'tower': true,'feild_pos':'rtl'})" href="#" id="field-red-tower-left"><div> &nbsp;  &nbsp; </div></a></td>
                    </tr>
                    <tr>
                        <td class="white-outline" colspan="2"><a ng-click="lightbox({'tower': true,'feild_pos':'btr'})" href="#" id="field-blue-tower-right"><div> &nbsp;  &nbsp; </div></a></td>
                        <td class="blue-defense"><a ng-click="lightbox({'tower': false,'feild_pos':'B5'})" href="#" id="field-blue-d5"><div> {{ defenses.BlueD5 }} </div></a></td>
                        <td class="red-defense"><a ng-click="lightbox({'tower': false,'feild_pos':'R2'})" href="#" id="field-red-d2"><div> {{ defenses.RedD2 }} </div></a></td>
                    </tr>
                    <tr>
                        <td class="white-outline" colspan="2" rowspan="2"><a ng-click="lightbox({'tower': true,'feild_pos':'btc'})" href="#" id="field-blue-tower-center"><div> &nbsp;  &nbsp; </div></a></td>
                        <td class="blue-defense"><a ng-click="lightbox({'tower': false,'feild_pos':'B4'})" href="#" id="field-blue-d4"><div> {{ defenses.BlueD4 }} </div></a></td>
                        <td class="red-defense"><a ng-click="lightbox({'tower': false,'feild_pos':'R3'})" href="#" id="field-red-d3"><div> {{ defenses.RedD3 }} </div></a></td>
                        <td class="white-outline" colspan="2" rowspan="2"><a ng-click="lightbox({'tower': true,'feild_pos':'rtc'})" href="#" id="field-red-tower-center"><div> &nbsp;  &nbsp; </div></a></td>
                    </tr>
                    <tr>
                        <td class="blue-defense"><a ng-click="lightbox({'tower': false,'feild_pos':'B3'})" href="#" id="field-blue-d3"><div> {{ defenses.BlueD3 }} </div></a></td>
                        <td class="white-outline" colspan="2" rowspan="3"><a ng-click="lightbox({'tower': false,'feild_pos':'NN'})" href="#" id="field-near-neutral"><div> &nbsp;&nbsp;&nbsp;&nbsp;    </div></a></td>
                        <td class="red-defense"><a ng-click="lightbox({'tower': false,'feild_pos':'R4'})" href="#" id="field-red-d4"><div> {{ defenses.RedD4 }} </div></a></td>
                    </tr>
                    <tr>
                        <td class="white-outline" colspan="2" rowspan="2"><a  ng-click="lightbox({'tower': true,'feild_pos':'btl'})"href="#" id="field-blue-tower-left"><div> &nbsp;  &nbsp; </div></a></td>
                        <td class="blue-defense"><a ng-click="lightbox({'tower': false,'feild_pos':'B2'})" href="#" id="field-blue-d2"><div> {{ defenses.BlueD2 }} </div></a></td>
                        <td class="red-defense"><a ng-click="lightbox({'tower': false,'feild_pos':'R5'})" href="#" id="field-red-d5"><div> {{ defenses.RedD5 }} </div></a></td>
                        <td class="white-outline" colspan="2"><a ng-click="lightbox({'tower': true,'feild_pos':'rtr'})" href="#" id="field-red-tower-right"><div> &nbsp;  &nbsp; </div></a></td>
                    </tr>
                    <tr>
                        <td class="blue-defense"><a ng-click="lightbox({'tower': false,'feild_pos':'B1'})" href="#" id="field-blue-d1"><div> {{ defenses.BlueD1 }} </div></a></td>
                        <td class="red-outline" colspan="2"><a ng-click="lightbox()" href="#" id="field-red-passage"><div> &nbsp;  &nbsp; </div></a></td>
                        <td class="red-outline"><a ng-click="lightbox()" href="#" id="field-red-brattice"><div> &nbsp;  &nbsp; </div></a></td>
                    </tr>
                </table>
            </div>
        </div>

    <script src="js/jquery.min.js"></script>
    <script src="js/angular.min.js"></script>
    <script src="js/socket.io-1.4.5.js"></script>
          
    <script>
        var app = angular.module('scouting', []);
        app.controller('homepage', function ($scope, socket) {

            //set everything to false.
            $scope.tower = {};
            $scope.tower.climb = false;
            $scope.tower.challenge = false;
            $scope.tower.left = false;
            $scope.tower.front = false;
            $scope.tower.right = false;

            $scope.tower.high_goal = false;
            $scope.tower.low_goal = false;
            $scope.success = false;
            $scope.fail = false;

            $scope.defense = {};
            $scope.defense.crossed = true;
            $scope.defense.reached = true;

            $scope.robotAction = {};
            $scope.robotAction.defended = false;
            $scope.robotAction.collect = false;
            $scope.robotAction.passed = false;

            $scope.time = {};
            $scope.time.minutes = 00;
            $scope.time.seconds = 00;

            $scope.stopTime = 'false';

            //data from server
            $scope.defenses = {};

            $scope.first_name = '';
            $scope.last_name = '';
            
            $scope.waiting = 'false';
            
            $scope.current_match = 00;
            $scope.server_status = 'off';
            
            $scope.stopTime = 'false';

            socket.on('connect',function(){
               $scope.server_status = 'on'; 
            });
            
            socket.on('disconnect',function(){
                console.log('disconnected');
                $scope.server_status = 'off';
            });
            
            setTimeout(function(){
                if($scope.server_status == 'on'){
                    setTimeout(function(){
                        $('#start_screen').animate({'opacity':0.0},400);
                        $('#header').animate({'height':'80px'},700);
                        setTimeout(function(){
                            $('#header').css({'position':'relative'});
                           $('#header .container,.container').animate({'opacity':'1.0'}); 
                        },700);
                    },2000);
                }
            },900);
            
            
            
            
            
            $scope.scouter_login = function(){
                //validate login_inputs
                console.log('click');
                if($scope.first_name && $scope.last_name){
                    $('#login_inputs').css({'display':'none'});
                    $('#title_screen').animate({'height':'400px'},700);
                    $scope.waiting = true;
                    console.log($scope.first_name);
                    socket.emit('scouter_connect',{'fN':$scope.first_name,'lN':$scope.last_name});
                }
                
            };
            
            socket.on('prepare_match',function(data){
                $('#home_screen').animate({ 'top': '-675px' });
                setTimeout(function () {
                    $('#scouting-container').css({ 'z-index': '1' });
                },900);
                $scope.scouting_data = data;

                $scope.defenses.RedD1 = data.response.defenses.red1;
                $scope.defenses.RedD2 = data.response.defenses.red2;
                $scope.defenses.RedD3 = data.response.defenses.red3;
                $scope.defenses.RedD4 = data.response.defenses.red4;
                $scope.defenses.RedD5 = data.response.defenses.red5;

                $scope.defenses.BlueD1 = data.response.defenses.blue1;
                $scope.defenses.BlueD2 = data.response.defenses.blue2;
                $scope.defenses.BlueD3 = data.response.defenses.blue3;
                $scope.defenses.BlueD4 = data.response.defenses.blue4;
                $scope.defenses.BlueD5 = data.response.defenses.blue5;

                console.log(data.response.defenses);
                //setTime to default
                $('#scouter_time').html('0:00');
                $('#time-bar').css({ 'width': $scope.t * bar_width + 'px' });
            });

            socket.on('start_match', function (data) {
                if (data == 'true') {
                    console.log('start match');
                    $('#scouting_overlay').css({ 'display': 'none' });
                    $scope.t = 0;
                    $scope.start_match();
                }
            });

            socket.on('stop_match', function (data) {
                $scope.stopTime = 'true';
                console.log('stop match');
                $('#scouting_overlay').css({ 'display': 'block' });
                $('#home_screen').animate({ 'top': '-0px' });
                $('#scouting-container').css({ 'z-index': '-1' });
            });

            bar_width = 1024 / 150;
            $scope.t = 0;
            $scope.start_match = function () {
  

                if ($scope.t < 150) {
                    if ($scope.stopTime == 'false') {
                        setTimeout(function () {
                            $scope.start_match();
                        }, 1000);
                    } else {
                        
                        console.log('stopped');
                        setTimeout(function () { $('#scouter_time').html('0:00'); $scope.stopTime = 'false'; }, 1000);
                        $scope.t = 0;
                        console.log($scope.t);
                    }
                } else {
                    console.log('match');
                }

                if ($scope.t >= 120) { m = 2; s = $scope.t - 120; } else { m = 0; s = $scope.t; }
                if ($scope.t >= 60 && $scope.t < 120) { m = 1; s = $scope.t - 60; }

                if ($scope.t <= 9 && s <= 9) { s = '0' + $scope.t; }
                if ($scope.t > 60 && ($scope.t - 60) <= 9) { s = '0' + ($scope.t - 60); }
                if ($scope.t >= 120 && ($scope.t - 120) <= 9) { s = '0' + ($scope.t - 120); }
                if (s == 0) { s = '00'; }
                console.log(m + ':' + s);
                $('#scouter_time').html(m + ':' + s);
                
                console.log($scope.t * bar_width);
                $('#time-bar').animate({ 'width': $scope.t * bar_width + 'px' }, 1001);
                if ($scope.t >= 120) { $('#time-bar').attr({ 'class': 'yellow' }); }
                if ($scope.t >= 150) { $('#time-bar').attr({ 'class': 'red' }); }

                $scope.t++;
            }


            $scope.lightbox = function (data) {

                $scope.tower.climb = false;
                $scope.tower.challenge = false;
                $scope.tower.left = false;
                $scope.tower.front = false;
                $scope.tower.right = false;

                $scope.tower.high_goal = false;
                $scope.tower.low_goal = false;
                $scope.tower.success = false;
                $scope.tower.fail = false;

                $scope.defense.crossed = false;
                $scope.defense.reached = false;

                $scope.robotAction.defended = false;
                $scope.robotAction.collect = false;
                $scope.robotAction.passed = false;

                $('#lightbox, #overlay').css({ 'display': 'block' })
                if (data.tower == true) {
                    $scope.lb_change = 'climb';
                    if (data.feild_pos == 'rtl' || data.feild_pos == 'btl') { $scope.tower.left = true; }
                    if (data.feild_pos == 'rtc' || data.feild_pos == 'btc') { $scope.tower.front = true; }
                    if (data.feild_pos == 'rtr' || data.feild_pos == 'btr') { $scope.tower.right = true; }
                } else {
                    $scope.lb_change = '';
                }

               
            }
            $scope.close_lightbox = function () {
                $('#lightbox, #overlay').css({'display':'none'})
            }

            socket.on('scouter_disconnect',function(data){
                 console.log(data);
            });
        });
        
        
        app.factory('socket', function ($rootScope) {
        var socket = io.connect();
        return {
        on: function (eventName, callback) {
        socket.on(eventName, function () {
            var args = arguments;
            $rootScope.$apply(function () {
                callback.apply(socket, args);
            });
        });
        },
        emit: function (eventName, data, callback) {
        socket.emit(eventName, data, function () {
            var args = arguments;
            $rootScope.$apply(function () {
                if (callback) {
                    callback.apply(socket, args);
                }
            });
        })
        }
        };
        });
    </script>
    </body>
</html>