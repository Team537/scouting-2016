<html lang="en" ng-app="scouting" ng-controller="homepage">
    <head>
        <title>Scouting</title>
    </head>
    <style>
        body{
            padding: 0;
            margin: 0;
            font-family: sans-serif;
        }
        #contianer{
            width: 1024px;
            height: 528px;
            overflow: hidden;
        }
            #home_screen{
                width: 1024px;
                height: 388px;
                position: relative;
            }
        #title_screen{
            width: 1024px;
            height: 250px;
            background: #e41e26;
            box-shadow: 0px 0px 10px #000;
            border-bottom: thin solid #000;
            position: relative;
            z-index: 1;
        }
            #title_screen #title{
                position: absolute;
                top: 50%;
                left: 50%;
                height: 213px;
                margin-top: -106.5px;
                margin-left: -394px;
            }
        #login_inputs-container{
            width: 1024px;
            height: 271px;
            position: absolute;
            background: #474747;
        }
        #login_inputs{
            height: 200px;
            width: 930px;
            margin: auto;
            margin-top: 40px;
            position: relative;
        }
        #login_inputs input{ width: 458px; height: 70px; padding-left: 10px; font-size: 50px; border: thin solid #cccccc; float: left; }
        
        #ready_button{
            background: #34aa49;
            border-radius: 10px;
            margin-top: -28px;
            width: 930px;
            height: 76px;
            position: absolute;
            bottom: 0px;
            box-shadow: 0px 6px 0px #2a803f;
            color: #2a803f;
        }
        #ready_button:hover{
            color: #fff;
            background: #2a803f;
            box-shadow: inset 0px 0px 5px #000;
        }
        #ready_button div{ 
            width: 930px;
            height: 77px;
            display: table-cell;
            vertical-align: middle;
            text-align: center;
            font-size: 58px;
            font-weight: bold;

        }
        
        
        h1,h2,h3,h4,h5,p {
            padding: 0;
            margin: 0;
        }



        /*Scouting portion*/
        #scouting-container{
            position: absolute;
            top: 0;
            z-index:1;
        }
        #title_bar{
            background: #e8e8e8;
            height: 60px;
            width: 1024px;
            position: relative;
            z-index: 1;
            box-shadow: 0px 0px 5px #000;
        }
        #field-diagram-table {
            width: 1024px;
            height: 433px;
            border-collapse: separate; 
            border-spacing: 2px; 
            background-color:#273F2E;
            margin:0;
            padding: 0;
        }
        #field-diagram-table td {
            height: 75px;
            vertical-align: middle;
            margin:0;
        }        
        #field-diagram-table td a {
            display:block;
            width:100%;
            height: 100%;
            text-align: center;
            color: #fff;
        }
        #field-diagram-table td a div {
            position: relative;
            top: 39%;
        }
        
        .field-column-header { width: 100px; }
        #field-diagram-table td.blue-outline { border: 2px solid blue; }
        #field-diagram-table td.white-outline { border: 2px solid white; }
        #field-diagram-table td.blue-defense { background-color: blue; border: 2px solid yellow; }
        #field-diagram-table td.red-outline { border: 2px solid red; }
        #field-diagram-table td.red-defense { background-color: red; border: 2px solid yellow; }

        #scouting_team{
            float: left;
            margin: 4px 0px 0px 10px;
            border: thin solid #333;
            padding: 0px 20px;
            font-size: 30px;
        }
        .red{
            background: red;
            color: #fff;
        }
        .blue{
            background: blue;
            color: #fff;
        }
        #scouter_name{
            float: right;
            height: 30px;
            font-size: 30px;
            margin: 10px 10px 0 0;
        }

        #scouter_time{
            font-size: 30px;
            width: 100%;
            padding-top: 10px;
            text-align: center;
        }
        #scouter-time-bar{
            width: 100%;
            height: 10px;
            background: #333;
            position: absolute;
            bottom: 0px;
        }
    #overlay{
        width: 100%;
        height: 100%;
        position: absolute;
        background: #000;
        opacity: 0.3;
        z-index: 5;
    }
    #lightbox{
        background: #cccccc;
        height: 300px;
        width: 582px;
        position: absolute;
        z-index: 5;
        left: 50%;
        top: 50%;
        margin-left: -291px;
        margin-top: -150px;
    }
        #lightbox #title{
            width: 582px;
            height: 70px;
            background: #474747;
            position: relative;
        }
        #lightbox #button{
            background: #ebebeb;
            color: #4c4c4d;
            border-radius: 5px;
            box-shadow: 0px 3px 0px #bcbcbc;
            font-size: 30px;
            font-weight: 400;
            padding: 5px 10px;
            text-align: center;
            margin: 10px 10px;
        }
        #lightbox #button:hover{
            box-shadow: inset 0px 0px 5px #000;
            background: #4c4c4d;
            color: #fff;
        }
            #lightbox #title_container{
                position: relative;
            }
            #lightbox #title_container div{
                width: 100%;
                text-align: center;
                color: #fff;
                position: absolute;
                bottom: 10px;
                font-size: 25px;
            }
    </style>
    <body>
        <div id="contianer">
          
            <div ng-click="close_lightbox()" id="overlay"></div>  
            <div id="lightbox">
                <div id="title">
                    <div id="title_container" style="float: left; width: 33%; height: 100%; border-right: thin solid #ccc;">
                        <img style="position: absolute; left: -3px; bottom: 4px;" width="100px;" src="images/Defenses/C-2.png" />
                        <div style="left: 40px; top: 10px;">Defense</div>
                        <div style="left: 43px; top: 38px; font-size: 16px;">Auto/Teleop</div>
                    </div>
                    <div id="title_container" style="float: left; width: 33%; height: 100%; border-right: thin solid #ccc;">
                        <img style="position: absolute; left: 10px; bottom: 5px;" src="images/tower_png.png" />
                        <div style="left: 33px; top: 10px;">Tower</div>
                        <div style="left: 43px; top: 38px; font-size: 16px;">Shot attempt</div>
                    </div>
                    <div id="title_container" style="float: left; width: 33%; height: 100%;">
                        <img style="position: absolute; left: 5px; bottom: -3px;" src="images/tablet.png" />
                        <div style="left: 40px; top: 4px;">Scouter<br/>Actions</div>
                        <div style="left: 43px; top: 38px; font-size: 16px;"></div>
                    </div>
                </div>
                <div style="position: relative; height: 100%; width: 100%;">
                    
                    <div style="width: 33%; border-right: thin solid #333; float: left; height: 230px;" id="column">
                        <div id="button">Reached</div>
                        <div id="button">Crossed</div>
                        
                    </div>

                    <div style="width: 33%; border-right: thin solid #333; float: left; height: 230px;" id="column">
                        <div id="button">High Goal</div>
                        <div id="button">Low Goal</div>
                        <div id="button">Success</div>
                        <div id="button">Fail</div>
                    </div>

                    <div style="width: 33%; float: left; height: 230px;" id="column">
                        <div id="button">Done</div>
                        <div id="button">Cancel</div>
                    </div>

                </div>
            </div>
            
              
            <div id="home_screen">
                <div id="title_screen">
                    
                    <div id="title">
                        <img style="float: left;" height="140px" src="images/team537_gear.png" />
                        <div style="border-left: 3px solid #000; color: #fff; padding-left: 20px; margin-left: 20px; float: left; margin-top: 20px;">
                            <h3 style="font-size: 30px; margin-left: 43px; margin-bottom: -23px;">2016</h3>
                            <h1 style="font-size: 70px;">Scouting System</h1>
                        </div>
                    </div>
                    
                    <h3 ng-if="waiting == true" style="color: #fff; width: 100%; position: absolute; bottom: 30px; font-size: 30px; text-align: center;">Waiting for admin command...</h3>
                </div>
                <div id="login_inputs-container">
                    <div id="login_inputs">
                        <input ng-model="first_name" placeholder="First Name" type="text" />
                        <input ng-model="last_name" style="margin-left: 14px;" placeholder="Last Name" type="text" />
                        <div ng-click="scouter_login()" id="ready_button"><div>READY</div></div>
                    </div>
                </div>
            </div>
            
            <div id="scouting-container">
                <div id="title_bar">
                    <div class="{{ scouting_data.scouting_team.alliance }}" id="scouting_team">{{ scouting_data.scouting_team.number }}</div>
                    <div id="scouter_name">{{ first_name }} {{ last_name }}</div>
                    <div id="scouter_time">00:00</div>
                    <div id="scouter-time-bar"></div>
                </div>
                <table id="field-diagram-table">
                    <tr>
                        <td class="blue-outline"><a ng-click="lightbox()" href="#" id="field-blue-brattice"><div>BB</div></a></td>
                        <td class="blue-outline" colspan="2"><a href="#" id="field-blue-passage"><div>BP</div></a></td>
                        <td class="white-outline" colspan="2" rowspan="3"><a href="#" id="field-far-neutral"><div>FN</div></a></td>
                        <td class="red-defense"><a href="#" id="field-red-d1"><div>R1</div></a></td>
                        <td class="white-outline" rowspan="2" colspan="2"><a href="#" id="field-red-tower-left"><div>RTL</div></a></td>
                    </tr>
                    <tr>
                        <td class="white-outline" colspan="2"><a href="#" id="field-blue-tower-right"><div>BTL</div></a></td>
                        <td class="blue-defense"><a href="#" id="field-blue-d5"><div>B5</div></a></td>
                        <td class="red-defense"><a href="#" id="field-red-d2"><div>R2</div></a></td>
                    </tr>
                    <tr>
                        <td class="white-outline" colspan="2" rowspan="2"><a href="#" id="field-blue-tower-center"><div>BTC</div></a></td>
                        <td class="blue-defense"><a href="#" id="field-blue-d4"><div>B4</div></a></td>
                        <td class="red-defense"><a href="#" id="field-red-d3"><div>R3</div></a></td>
                        <td class="white-outline" colspan="2" rowspan="2"><a href="#" id="field-red-tower-center"><div>RTC</div></a></td>
                    </tr>
                    <tr>
                        <td class="blue-defense"><a href="#" id="field-blue-d3"><div>B3</div></a></td>
                        <td class="white-outline" colspan="2" rowspan="3"><a href="#" id="field-near-neutral"><div>NN</div></a></td>
                        <td class="red-defense"><a href="#" id="field-red-d4"><div>R4</div></a></td>
                    </tr>
                    <tr>
                        <td class="white-outline" colspan="2" rowspan="2"><a href="#" id="field-blue-tower-left"><div>BTL</div></a></td>
                        <td class="blue-defense"><a href="#" id="field-blue-d2"><div>B2</div></a></td>
                        <td class="red-defense"><a href="#" id="field-red-d5"><div>R5</div></a></td>
                        <td class="white-outline" colspan="2"><a href="#" id="field-red-tower-right"><div>RTR</div></a></td>
                    </tr>
                    <tr>
                        <td class="blue-defense"><a href="#" id="field-blue-d1"><div>B1</div></a></td>
                        <td class="red-outline" colspan="2"><a href="#" id="field-red-passage"><div>RP</div></a></td>
                        <td class="red-outline"><a href="#" id="field-red-brattice"><div>RB</div></a></td>
                    </tr>
                </table>
            </div>
        </div>

    <script src="js/jquery.min.js"></script>
    <script src="js/angular.min.js"></script>
    <script src="js/socket.io-1.4.5.js"></script>
          
    <script>
        var app = angular.module('scouting', []);
        app.controller('homepage', function ($scope, socket) {
            $scope.first_name = '';
            $scope.last_name = '';
            
            $scope.waiting = 'false';
            
            $scope.current_match = 00;
            $scope.server_status = 'off';
            
            socket.on('connect',function(){
               $scope.server_status = 'on'; 
            });
            
            socket.on('disconnect',function(){
                console.log('disconnected');
                $scope.server_status = 'off';
            });
            
            setTimeout(function(){
                if($scope.server_status == 'on'){
                    setTimeout(function(){
                        $('#start_screen').animate({'opacity':0.0},400);
                        $('#header').animate({'height':'80px'},700);
                        setTimeout(function(){
                            $('#header').css({'position':'relative'});
                           $('#header .container,.container').animate({'opacity':'1.0'}); 
                        },700);
                    },2000);
                }
            },900);
            
            
            
            
            
            $scope.scouter_login = function(){
                //validate login_inputs
                console.log('click');
                if($scope.first_name && $scope.last_name){
                    $('#login_inputs').css({'display':'none'});
                    $('#title_screen').animate({'height':'400px'},700);
                    $scope.waiting = true;
                    console.log($scope.first_name);
                    socket.emit('scouter_connect',{'fN':$scope.first_name,'lN':$scope.last_name});
                }
                
            };
            
            socket.on('prepare_match',function(data){
                $('#home_screen').animate({ 'top': '-675px' });
                setTimeout(function () {
                    $('#scouting-container').css({ 'z-index': '1' });
                },900);
                $scope.scouting_data = data;
                console.log(data.scouting_team);
                
            });
            


            $scope.lightbox = function (){
                $('#lightbox, #overlay').css({'display':'block'})
            }
            $scope.close_lightbox = function () {
                $('#lightbox, #overlay').css({'display':'none'})
            }

            socket.on('scouter_disconnect',function(data){
                 console.log(data);
            });
        });
        
        
        app.factory('socket', function ($rootScope) {
        var socket = io.connect();
        return {
        on: function (eventName, callback) {
        socket.on(eventName, function () {
            var args = arguments;
            $rootScope.$apply(function () {
                callback.apply(socket, args);
            });
        });
        },
        emit: function (eventName, data, callback) {
        socket.emit(eventName, data, function () {
            var args = arguments;
            $rootScope.$apply(function () {
                if (callback) {
                    callback.apply(socket, args);
                }
            });
        })
        }
        };
        });
    </script>
    </body>
</html>